<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nhập thông tin khách hàng - Candy Agency</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body class="bg-gradient-primary">
  <header class="app-header shadow-sm rounded-bottom" style="background:#2563eb !important; border-radius:0 0 2rem 2rem !important;">
    <div class="px-3 py-2">
      <div id="agencyHeaderInfo" class="d-flex align-items-center gap-2 mb-1" style="cursor:pointer;">
        <span class="logo-icon">
          <svg width="28" height="28" fill="none" viewBox="0 0 24 24"><circle cx="12" cy="12" r="12" fill="#4F8CFF"/><path d="M7 17l5-9 5 9" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </span>
        <span class="fw-bold fs-5 text-white text-truncate">ĐẠI LÝ BÁNH KẸO - LÊ VĂN LƯƠNG</span>
      </div>
      <div id="agencyAddressInfo" class="d-flex align-items-center gap-2 mb-1" style="cursor:pointer;">
        <span style="color:#d72660;">
          <svg width="18" height="18" fill="none" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5A2.5 2.5 0 1 1 12 6a2.5 2.5 0 0 1 0 5.5z" fill="#d72660"/></svg>
        </span>
        <span class="text-white text-truncate">Tầng 4 Diamond Place, 25 Lê Văn Lương, TP. Hà Nội</span>
      </div>
    </div>
  </header>
  <main class="container py-3">
    <!-- Top carousel overview banners (same as overview) -->
    <div id="overviewCarousel" class="carousel slide mb-3" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#overviewCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner rounded-3 overflow-hidden">
        <div class="carousel-item active">
          <img src="https://picsum.photos/1200/400?random=101" class="d-block w-100" alt="Banner 1">
          <div class="carousel-caption d-none d-md-block text-start">
            <h5>Khuyến mãi mùa lễ hội</h5>
            <p>Giảm giá đến 30% cho các đơn hàng đại lý lớn.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://picsum.photos/1200/400?random=102" class="d-block w-100" alt="Banner 2">
          <div class="carousel-caption d-none d-md-block">
            <h5>Sản phẩm mới</h5>
            <p>Thử ngay bánh kẹo hương vị giới hạn của chúng tôi.</p>
          </div>
        </div>
        <div class="carousel-item">
          <img src="https://picsum.photos/1200/400?random=103" class="d-block w-100" alt="Banner 3">
          <div class="carousel-caption d-none d-md-block text-end">
            <h5>Giao hàng nhanh</h5>
            <p>Hỗ trợ giao hàng toàn quốc cho đại lý.</p>
          </div>
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#overviewCarousel" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#overviewCarousel" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>

    <div class="card shadow-sm rounded-4 p-3 mb-4">
      <h4 class="mb-3 text-center text-primary">Nhập thông tin khách hàng</h4>
      <form id="customerInfoFormPage" class="mb-2">
        <div class="mb-2">
          <label for="customerName" class="form-label">Tên khách hàng</label>
          <input type="text" class="form-control rounded-3" name="customerName" required>
        </div>
        <div class="mb-2">
          <label for="customerPhone" class="form-label">Số điện thoại</label>
          <div class="input-group">
            <span class="input-group-text">
              <img src="https://cdn.jsdelivr.net/gh/lipis/flag-icons/flags/4x3/vn.svg" alt="VN" style="width:22px;height:16px;margin-right:4px;"> +84
            </span>
            <input type="tel" class="form-control rounded-3" id="customerPhone" name="customerPhone" required maxlength="10">
          </div>
          <div class="form-text text-danger d-none" id="phoneError">Số điện thoại không hợp lệ. Vui lòng nhập đúng định dạng Việt Nam.</div>
        </div>
        <button type="submit" class="btn btn-primary w-100 rounded-3">Lưu và tiếp tục</button>
      </form>
    </div>

    <!-- Popup modal for agency info -->
    <div class="modal fade" id="agencyInfoModal" tabindex="-1" aria-labelledby="agencyInfoModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="agencyInfoModalLabel">Thông tin đại lý</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
          </div>
          <div class="modal-body">
            <div class="mb-2 fw-bold">ĐẠI LÝ BÁNH KẸO - LÊ VĂN LƯƠNG</div>
            <div class="mb-2 text-secondary">Tầng 4 Diamond Place, 25 Lê Văn Lương, TP. Hà Nội</div>
            <div class="mb-2"><span class="fw-bold">Số điện thoại:</span> <a href="tel:0909123456" class="text-primary text-decoration-none">0909 123 456</a></div>
            <div class="mb-2">
              <iframe width="100%" height="220" style="border-radius:12px;border:none;" src="https://www.google.com/maps?q=25+L%C3%AA+V%C4%83n+L%C6%B0%C6%A1ng,+Qu%E1%BA%ADn+7,+TP.+H%E1%BB%93+Ch%C3%AD+Minh&output=embed"></iframe>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </main>
  <script>
    // Save customer info to localStorage then redirect to home
    document.getElementById('customerInfoFormPage').addEventListener('submit', function(e) {
      var phoneInput = document.getElementById('customerPhone');
      var phoneError = document.getElementById('phoneError');
      var phone = phoneInput.value.trim();
      // Điều kiện số điện thoại Việt Nam: 10 số, bắt đầu bằng 0 hoặc không, tiếp theo là 9,8,7,5,3
      var regex = /^(0)?[3|5|7|8|9][0-9]{8}$/;
      if (!regex.test(phone)) {
        e.preventDefault();
        phoneError.classList.remove('d-none');
        phoneInput.classList.add('is-invalid');
        phoneInput.focus();
        return false;
      } else {
        phoneError.classList.add('d-none');
        phoneInput.classList.remove('is-invalid');
      }
      e.preventDefault();
      const info = {
        customerName: this.customerName.value,
        customerPhone: this.customerPhone.value
      };
      try { localStorage.setItem('customerInfo', JSON.stringify(info)); } catch (err) {}
      window.location.href = '/';
    });
    document.getElementById('agencyHeaderInfo').onclick = function() {
      var modal = bootstrap.Modal.getOrCreateInstance(document.getElementById('agencyInfoModal'));
      modal.show();
    };
    document.getElementById('agencyAddressInfo').onclick = function() {
      var modal = bootstrap.Modal.getOrCreateInstance(document.getElementById('agencyInfoModal'));
      modal.show();
    };
  </script>
</body>
</html>
